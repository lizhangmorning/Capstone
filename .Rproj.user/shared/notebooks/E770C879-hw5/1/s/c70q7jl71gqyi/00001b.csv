"0","# 加载必要包"
"0","library(ggplot2)"
"0",""
"0","# 自定义参数"
"0","p <- 6"
"0","q <- 1"
"0","Rsq.red <- 0.07701938"
"0","Rsq.full <- 0.1274526"
"0","alpha <- 0.05"
"0","power <- 0.8"
"0",""
"0","# 基准样本量，用于红点"
"0","N_base <- mlrF.partial(N = NULL, p = p, q = q,"
"0","                       Rsq.red = Rsq.red, Rsq.full = Rsq.full,"
"0","                       alpha = alpha, power = power)"
"0",""
"0","### 1. 效应大小敏感性分析 ###"
"0","effect_sizes <- seq(0.01, 0.4, by = 0.01)"
"0","N_effect <- sapply(effect_sizes, function(es) {"
"0","  mlrF.partial(N = NULL, p = p, q = q,"
"0","               Rsq.red = Rsq.red, Rsq.full = Rsq.red + es,"
"0","               alpha = alpha, power = power)"
"0","})"
"0","df_effect <- data.frame(Effect_Size = effect_sizes, Sample_Size = N_effect)"
"0",""
"0","# 图1：样本量 vs 效应大小"
"0","plot1 <- ggplot(df_effect, aes(x = Effect_Size, y = Sample_Size)) +"
"0","  geom_line() +"
"0","  geom_point(aes(x = Rsq.full - Rsq.red, y = N_base), color = ""red"", size = 3) +"
"0","  labs(title = ""Sample Size vs Effect Size (Rsq.full - Rsq.red)"","
"0","       x = ""Effect Size"", y = ""Required Sample Size"") +"
"0","  theme_minimal()"
"0",""
"0","### 2. alpha 敏感性分析 ###"
"0","alpha_vals <- seq(0.001, 0.1, by = 0.005)"
"0","N_alpha <- sapply(alpha_vals, function(a) {"
"0","  mlrF.partial(N = NULL, p = p, q = q,"
"0","               Rsq.red = Rsq.red, Rsq.full = Rsq.full,"
"0","               alpha = a, power = power)"
"0","})"
"0","df_alpha <- data.frame(Alpha = alpha_vals, Sample_Size = N_alpha)"
"0",""
"0","# 图2：样本量 vs Alpha"
"0","plot2 <- ggplot(df_alpha, aes(x = Alpha, y = Sample_Size)) +"
"0","  geom_line() +"
"0","  geom_point(aes(x = alpha, y = N_base), color = ""red"", size = 3) +"
"0","  labs(title = ""Sample Size vs Alpha (Significance Level)"","
"0","       x = ""Alpha"", y = ""Required Sample Size"") +"
"0","  theme_minimal()"
"0",""
"0","### 3. Power 敏感性分析 ###"
"0","power_vals <- seq(0.7, 0.99, by = 0.01)"
"0","N_power <- sapply(power_vals, function(pwr) {"
"0","  mlrF.partial(N = NULL, p = p, q = q,"
"0","               Rsq.red = Rsq.red, Rsq.full = Rsq.full,"
"0","               alpha = alpha, power = pwr)"
"0","})"
"0","df_power <- data.frame(Power = power_vals, Sample_Size = N_power)"
"0",""
"0","# 图3：样本量 vs Power"
"0","plot3 <- ggplot(df_power, aes(x = Power, y = Sample_Size)) +"
"0","  geom_line() +"
"0","  geom_point(aes(x = power, y = N_base), color = ""red"", size = 3) +"
"0","  labs(title = ""Sample Size vs Power"","
"0","       x = ""Power"", y = ""Required Sample Size"") +"
"0","  theme_minimal()"
"0",""
"0","# 打印所有图"
"0","print(plot1)"
