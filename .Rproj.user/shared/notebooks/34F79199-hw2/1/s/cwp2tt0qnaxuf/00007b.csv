"0","library(ggplot2)"
"0","library(PowerTOST)"
"0",""
"0","# 设置敏感性分析的参数"
"0","theta0_vals <- seq(-0.9, 0.9, by = 0.1)  # 从 -0.9 到 0.9 步长为 0.1"
"0","sigma <- 3                               # 固定标准差"
"0","CV <- sigma                              # 因为 logscale = FALSE，直接用σ作为CV"
"0","alpha <- 0.05"
"0","targetpower <- 0.80"
"0","theta1 <- -1"
"0","theta2 <- 1"
"0","logscale <- FALSE"
"0","design <- ""parallel"""
"0",""
"0","# 初始化结果存储向量"
"0","n_vals <- numeric(length(theta0_vals))"
"0",""
"0","# 计算每个theta0对应的样本量"
"0","for (i in 1:length(theta0_vals)) {"
"0","  result <- suppressMessages(suppressWarnings("
"0","    sampleN.TOST(alpha = alpha,"
"0","                 targetpower = targetpower,"
"0","                 logscale = logscale,"
"0","                 theta0 = theta0_vals[i],"
"0","                 theta1 = theta1,"
"0","                 theta2 = theta2,"
"0","                 CV = CV,"
"0","                 design = design,"
"0","                 print = FALSE)"
"0","  ))"
"0","  n_vals[i] <- result$`Sample size`"
"0","}"
"0",""
"0","# 整理数据并绘图"
"0","df <- data.frame(Theta0 = theta0_vals, SampleSize = ceiling(n_vals))"
"0",""
"0","ggplot(df, aes(x = Theta0, y = SampleSize)) +"
"0","  geom_line(color = ""darkgreen"", size = 1.2) +"
"0","  geom_point(color = ""orange"") +"
"0","  labs(title = ""Sensitivity Analysis of Required Sample Size"","
"0","       subtitle = ""Varying Actual Mean Difference (theta0), SD = 3, α = 0.05, Power = 80%"","
"0","       x = ""Assumed True Difference (θ₀)"","
"0","       y = ""Required Sample Size per Group"") +"
"0","  theme_minimal(base_size = 14)"
"0",""
